<!-- counsellor-dashboard.component.html -->
<div class="counsellor-dashboard">
    <!-- Sidebar Navigation -->
    <div class="sidebar">
      <div class="logo">
        <h2>mindscape</h2>
      </div>
      
      <div class="user-info">
        <div class="avatar">
          <img src="/api/placeholder/60/60" alt="Counsellor Avatar" />
        </div>
        <div class="user-details">
          <h3>{{ currentUser?.name }}</h3>
          <p>Counsellor</p>
        </div>
      </div>
      
      <nav class="nav-menu">
        <ul>
          <li [class.active]="activeSection === 'overview'">
            <a href="#overview" (click)="setActiveSection('overview')">
              <i class="fas fa-chart-line"></i> Dashboard
            </a>
          </li>
          <li [class.active]="activeSection === 'students'">
            <a href="#students" (click)="setActiveSection('students')">
              <i class="fas fa-users"></i> Students
            </a>
          </li>
          <li [class.active]="activeSection === 'sessions'">
            <a href="#sessions" (click)="setActiveSection('sessions')">
              <i class="fas fa-calendar-alt"></i> Sessions
            </a>
          </li>
          <li [class.active]="activeSection === 'messages'">
            <a href="#messages" (click)="setActiveSection('messages')">
              <i class="fas fa-comments"></i> Messages
            </a>
          </li>
          <li [class.active]="activeSection === 'community'">
            <a href="#community" (click)="setActiveSection('community')">
              <i class="fas fa-comment-dots"></i> Community
            </a>
          </li>
          <li [class.active]="activeSection === 'reports'">
            <a href="#reports" (click)="setActiveSection('reports')">
              <i class="fas fa-file-alt"></i> Reports
            </a>
          </li>
        </ul>
      </nav>
    </div>
  
    <!-- Main Content Area -->
    <div class="main-content">
      <header class="dashboard-header">
        <h1>Counsellor Dashboard</h1>
        <div class="user-actions">
          <div class="notifications">
            <i class="fas fa-bell"></i>
            <span class="badge">3</span>
          </div>
          <div class="messages">
            <i class="fas fa-envelope"></i>
            <span class="badge">2</span>
          </div>
          <div class="profile">
            <img src="/api/placeholder/40/40" alt="Profile" />
          </div>
        </div>
      </header>
  
      <!-- Dashboard Overview Section -->
      <section id="overview" class="dashboard-section" *ngIf="activeSection === 'overview'">
        <h2>Dashboard Overview</h2>
        
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
              <h3>Total Students</h3>
              <p class="stat-value">{{ dashboardData?.totalUsers || 0 }}</p>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-book"></i>
            </div>
            <div class="stat-info">
              <h3>Journal Entries</h3>
              <p class="stat-value">{{ dashboardData?.totalJournalEntries || 0 }}</p>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-smile"></i>
            </div>
            <div class="stat-info">
              <h3>Mood Entries</h3>
              <p class="stat-value">{{ dashboardData?.totalMoodEntries || 0 }}</p>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-flag"></i>
            </div>
            <div class="stat-info">
              <h3>Goals</h3>
              <p class="stat-value">{{ dashboardData?.totalGoals || 0 }}</p>
            </div>
          </div>
        </div>
        
        <div class="dashboard-row">
          <div class="dashboard-card mood-distribution">
            <h3>Mood Distribution</h3>
            <div class="chart-container">
              <!-- Placeholder for mood distribution chart -->
              <div class="mood-bars">
                <div *ngFor="let mood of dashboardData?.moodDistribution" class="mood-bar">
                  <div class="mood-label">{{ mood.mood }}</div>
                  <div class="mood-bar-container">
                    <div class="mood-bar-fill" 
                         [style.width]="(mood.count / (dashboardData?.totalMoodEntries || 1) * 100) + '%'"
                         [ngClass]="mood.mood.toLowerCase()">
                    </div>
                  </div>
                  <div class="mood-count">{{ mood.count }}</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="dashboard-card recent-users">
            <h3>Recent Students</h3>
            <ul class="recent-user-list">
              <li *ngFor="let user of dashboardData?.recentUsers">
                <div class="user-avatar">
                  <img src="/api/placeholder/40/40" alt="User Avatar">
                </div>
                <div class="user-info">
                  <h4>{{ user.name }}</h4>
                  <p>{{ user.faculty || 'No Faculty' }}</p>
                </div>
                <div class="user-actions">
                  <button class="btn btn-sm" (click)="viewStudentDetails(user)">View</button>
                </div>
              </li>
            </ul>
          </div>
        </div>
        
        <div class="dashboard-row">
          <div class="dashboard-card upcoming-sessions">
            <h3>Upcoming Sessions</h3>
            <table class="sessions-table">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Date</th>
                  <th>Time</th>
                  <th>Students</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let session of counselorSessions?.slice(0, 5)">
                  <td>{{ session.title }}</td>
                  <td>{{ session.date | date }}</td>
                  <td>{{ session.startTime }} - {{ session.endTime }}</td>
                  <td>{{ session.participants?.length || 0 }}/{{ session.maxParticipants }}</td>
                </tr>
                <tr *ngIf="!counselorSessions?.length">
                  <td colspan="4" class="text-center">No upcoming sessions</td>
                </tr>
              </tbody>
            </table>
            <div class="card-footer">
              <a href="#sessions" (click)="setActiveSection('sessions')">View All Sessions</a>
            </div>
          </div>
        </div>
      </section>
  
      <!-- Students Section -->
      <section id="students" class="dashboard-section" *ngIf="activeSection === 'students'">
        <h2>Student Management</h2>
        
        <div class="student-filters">
          <div class="form-group">
            <label for="faculty-filter">Filter by Faculty:</label>
            <select id="faculty-filter" [(ngModel)]="selectedFaculty" (change)="filterStudentsByFaculty()">
              <option value="">All Faculties</option>
              <option *ngFor="let faculty of faculties" [value]="faculty">{{ faculty }}</option>
            </select>
          </div>
          
          <div class="search-box">
            <input type="text" placeholder="Search students...">
            <button><i class="fas fa-search"></i></button>
          </div>
        </div>
        
        <div class="students-container" *ngIf="!selectedStudent">
          <table class="students-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Faculty</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let student of filteredStudents">
                <td>
                  <div class="student-info">
                    <img src="/api/placeholder/40/40" alt="Student">
                    <span>{{ student.name }}</span>
                  </div>
                </td>
                <td>{{ student.email }}</td>
                <td>{{ student.faculty || 'No Faculty' }}</td>
                <td>
                  <span class="status-badge" [ngClass]="student.status || 'offline'">
                    {{ student.status || 'Offline' }}
                  </span>
                </td>
                <td>
                  <button class="btn btn-sm" (click)="viewStudentDetails(student)">
                    <i class="fas fa-eye"></i> View
                  </button>
                  <button class="btn btn-sm" (click)="loadConversation(student); setActiveSection('messages')">
                    <i class="fas fa-comment"></i> Message
                  </button>
                </td>
              </tr>
              <tr *ngIf="!filteredStudents.length">
                <td colspan="5" class="text-center">No students found</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <!-- Student Detail View -->
        <div class="student-details" *ngIf="selectedStudent">
          <div class="back-button">
            <button (click)="selectedStudent = null">
              <i class="fas fa-arrow-left"></i> Back to Students
            </button>
          </div>
          
          <div class="student-profile">
            <div class="profile-header">
              <div class="profile-image">
                <img src="/api/placeholder/100/100" alt="Student Profile">
              </div>
              <div class="profile-info">
                <h3>{{ selectedStudent.name }}</h3>
                <p>{{ selectedStudent.email }}</p>
                <p>{{ selectedStudent.faculty || 'No Faculty' }}</p>
                <div class="profile-actions">
                  <button class="btn" (click)="loadConversation(selectedStudent); setActiveSection('messages')">
                    <i class="fas fa-comment"></i> Message
                  </button>
                  <button class="btn" (click)="generateStudentReport()">
                    <i class="fas fa-file-alt"></i> Generate Report
                  </button>
                </div>
              </div>
            </div>
            
            <div class="progress-tabs">
              <ul class="tab-nav">
                <li class="active"><a href="#journals">Journals</a></li>
                <li><a href="#moods">Mood Tracking</a></li>
                <li><a href="#goals">Goals</a></li>
              </ul>
              
              <div class="tab-content">
                <!-- Journals Tab -->
                <div id="journals" class="tab-pane active">
                  <div class="date-filter">
                    <div class="form-group">
                      <label for="start-date">From:</label>
                      <input type="date" id="start-date" [(ngModel)]="startDate">
                    </div>
                    <div class="form-group">
                      <label for="end-date">To:</label>
                      <input type="date" id="end-date" [(ngModel)]="endDate">
                    </div>
                    <button class="btn" (click)="loadStudentJournalsByDateRange(selectedStudent.id || selectedStudent.userId || 0)">
                      Apply
                    </button>
                  </div>
                  
                  <div class="journals-container">
                    <div class="journal-list">
                      <div class="journal-entry" *ngFor="let entry of journalEntries" 
                           [class.active]="selectedJournal?.id === entry.id"
                           (click)="viewJournalEntry(entry.id)">
                        <div class="journal-date">
                          {{ entry.entry_date | date }}
                        </div>
                        <div class="journal-preview">
                          {{ entry.content | slice:0:50 }}{{ entry.content.length > 50 ? '...' : '' }}
                        </div>
                      </div>
                      <div *ngIf="!journalEntries.length" class="no-data">
                        No journal entries found.
                      </div>
                    </div>
                    
                    <div class="journal-detail" *ngIf="selectedJournal">
                      <h4>Journal Entry: {{ selectedJournal.entry_date | date }}</h4>
                      <div class="journal-content">
                        {{ selectedJournal.content }}
                      </div>
                      <div class="journal-mood" *ngIf="selectedJournal.mood_tag">
                        <p><strong>Mood:</strong> {{ selectedJournal.mood_tag }}</p>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Moods Tab -->
                <div id="moods" class="tab-pane">
                  <div class="date-filter">
                    <div class="form-group">
                      <label for="mood-start-date">From:</label>
                      <input type="date" id="mood-start-date" [(ngModel)]="startDate">
                    </div>
                    <div class="form-group">
                      <label for="mood-end-date">To:</label>
                      <input type="date" id="mood-end-date" [(ngModel)]="endDate">
                    </div>
                    <button class="btn" (click)="loadStudentMoodsByDateRange(selectedStudent.id || selectedStudent.userId || 0)">
                      Apply
                    </button>
                  </div>
                  
                  <div class="mood-chart-container">
                    <h4>Mood Tracking Over Time</h4>
                    <!-- Placeholder for mood line chart -->
                    <div class="mood-trend-chart">
                      <div class="chart-legend">
                        <div *ngFor="let option of moodOptions" class="legend-item">
                          <span class="color-box" [ngClass]="option.toLowerCase()"></span>
                          <span>{{ option }}</span>
                        </div>
                      </div>
                      
                      <div class="mood-timeline">
                        <div *ngFor="let data of moodChartData" class="mood-day">
                          <div class="mood-date">{{ data.date }}</div>
                          <div class="mood-markers">
                            <span *ngFor="let option of moodOptions" 
                                  [ngClass]="option.toLowerCase()"
                                  [style.opacity]="data[option] ? 1 : 0.1">‚óè</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="mood-summary">
                    <h4>Mood Distribution</h4>
                    <div class="mood-distribution">
                      <div *ngFor="let option of moodOptions" class="mood-stat">
                        <div class="mood-type">{{ option }}</div>
                        <div class="mood-bar-container">
                          <div class="mood-bar-fill" 
                               [ngClass]="option.toLowerCase()"
                               [style.width]="'20%'">
                          </div>
                        </div>
                        <div class="mood-percentage">20%</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Goals Tab -->
                <div id="goals" class="tab-pane">
                  <div class="goal-filters">
                    <button class="btn" (click)="loadStudentGoals(selectedStudent.id || selectedStudent.userId || 0)">
                      All Goals
                    </button>
                    <button class="btn" (click)="counsellorService.getStudentGoalsByStatus(selectedStudent.id || selectedStudent.userId || 0, false).subscribe(goals => studentGoals = goals)">
                      Active Goals
                    </button>
                    <button class="btn" (click)="counsellorService.getStudentGoalsByStatus(selectedStudent.id || selectedStudent.userId || 0, true).subscribe(goals => studentGoals = goals)">
                      Completed Goals
                    </button>
                  </div>
                  
                  <div class="goals-container">
                    <table class="goals-table">
                      <thead>
                        <tr>
                          <th>Goal</th>
                          <th>Created</th>
                          <th>Target Date</th>
                          <th>Progress</th>
                          <th>Status</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let goal of studentGoals">
                          <td>{{ goal.title }}</td>
                          <td>{{ goal.created_at | date }}</td>
                          <td>{{ goal.target_date | date }}</td>
                          <td>
                            <div class="progress-bar">
                              <div class="progress-fill" [style.width]="goal.progress_percentage + '%'"></div>
                            </div>
                            <span class="progress-text">{{ goal.progress_percentage }}%</span>
                          </td>
                          <td>
                            <span class="status-badge" [ngClass]="goal.is_completed ? 'completed' : 'active'">
                              {{ goal.is_completed ? 'Completed' : 'Active' }}
                            </span>
                          </td>
                          <td>
                            <button class="btn btn-sm" (click)="viewGoalDetails(goal.id)">
                              <i class="fas fa-eye"></i> View
                            </button>
                          </td>
                        </tr>
                        <tr *ngIf="!studentGoals.length">
                          <td colspan="6" class="text-center">No goals found</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  <!-- Goal Details Modal -->
                  <div class="modal" *ngIf="selectedGoal">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h3>{{ selectedGoal.title }}</h3>
                        <button (click)="selectedGoal = null" class="close-btn">&times;</button>
                      </div>
                      <div class="modal-body">
                        <div class="goal-detail">
                          <p><strong>Description:</strong> {{ selectedGoal.description }}</p>
                          <p><strong>Created:</strong> {{ selectedGoal.created_at | date }}</p>
                          <p><strong>Target Date:</strong> {{ selectedGoal.target_date | date }}</p>
                          <p><strong>Status:</strong> {{ selectedGoal.is_completed ? 'Completed' : 'Active' }}</p>
                          
                          <div class="progress-container">
                            <h4>Progress: {{ selectedGoal.progress_percentage }}%</h4>
                            <div class="progress-bar">
                              <div class="progress-fill" [style.width]="selectedGoal.progress_percentage + '%'"></div>
                            </div>
                          </div>
                          
                          <div class="goal-actions">
                            <div class="form-group">
                              <label>Update Progress:</label>
                              <input type="range" min="0" max="100" 
                                     [(ngModel)]="selectedGoal.progress_percentage" 
                                     class="progress-slider">
                              <span>{{ selectedGoal.progress_percentage }}%</span>
                            </div>
                            
                            <div class="form-group">
                              <label>Goal Status:</label>
                              <div class="toggle-switch">
                                <input type="checkbox" 
                                       [checked]="selectedGoal.is_completed"
                                       (change)="selectedGoal.is_completed = !selectedGoal.is_completed">
                                <span class="slider"></span>
                                <span class="status-text">{{ selectedGoal.is_completed ? 'Completed' : 'Active' }}</span>
                              </div>
                            </div>
                            
                            <button class="btn" (click)="updateGoalStatus(selectedGoal.id, selectedGoal.is_completed, selectedGoal.progress_percentage)">
                              Update Goal
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
  
      <!-- Sessions Section -->
      <section id="sessions" class="dashboard-section" *ngIf="activeSection === 'sessions'">
        <h2>Sessions Management</h2>
        
        <div class="session-container">
          <div class="session-cards">
            <div class="session-card">
              <div class="card-header">
                <h3>Schedule New Session</h3>
              </div>
              <div class="card-body">
                <form [formGroup]="sessionForm" (ngSubmit)="scheduleNewSession()">
                  <div class="form-group">
                    <label for="title">Session Title</label>
                    <input type="text" id="title" formControlName="title">
                  </div>
                  
                  <div class="form-group">
                    <label for="venue">Venue</label>
                    <input type="text" id="venue" formControlName="venue">
                  </div>
                  
                  <div class="form-row">
                    <div class="form-group">
                      <label for="date">Date</label>
                      <input type="date" id="date" formControlName="date">
                    </div>
                    
                    <div class="form-group">
                      <label for="startTime">Start Time</label>
                      <input type="time" id="startTime" formControlName="startTime">
                    </div>
                    
                    <div class="form-group">
                      <label for="endTime">End Time</label>
                      <input type="time" id="endTime" formControlName="endTime">
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" formControlName="description" rows="3"></textarea>
                  </div>
                  
                  <div class="form-group">
                    <label for="maxParticipants">Maximum Participants</label>
                    <input type="number" id="maxParticipants" formControlName="maxParticipants" min="1" max="100">
                  </div>
                  
                  <button type="submit" class="btn btn-primary" [disabled]="sessionForm.invalid">
                    Schedule Session
                  </button>
                </form>
              </div>
            </div>
            
            <div class="session-card">
              <div class="card-header">
                <h3>Update Availability</h3>
              </div>
              <div class="card-body">
                <form [formGroup]="availabilityForm" (ngSubmit)="updateAvailability()">
                  <div class="form-group">
                    <label for="day">Day of Week</label>
                    <select id="day" formControlName="day">
                      <option value="Monday">Monday</option>
                      <option value="Tuesday">Tuesday</option>
                      <option value="Wednesday">Wednesday</option>
                      <option value="Thursday">Thursday</option>
                      <option value="Friday">Friday</option>
                      <option value="Saturday">Saturday</option>
                      <option value="Sunday">Sunday</option>
                    </select>
                  </div>
                  
                  <div class="form-row">
                    <div class="form-group">
                      <label for="avail-startTime">Start Time</label>
                      <input type="time" id="avail-startTime" formControlName="startTime">
                    </div>
                    
                    <div class="form-group">
                      <label for="avail-endTime">End Time</label>
                      <input type="time" id="avail-endTime" formControlName="endTime">
                    </div>
                  </div>
                  
                  <button type="submit" class="btn btn-primary" [disabled]="availabilityForm.invalid">
                    Update Availability
                  </button>
                </form>
              </div>
            </div>
          </div>
          
          <div class="weekly-timetable">
            <h3>Weekly Schedule</h3>
            <div class="timetable-container">
              <div class="timetable-header">
                <div class="time-labels">
                  <div class="time-label" *ngFor="let hour of [8,9,10,11,12,13,14,15,16,17]">
                    {{ hour }}:00
                  </div>
                </div>
              </div>
              <div class="timetable-content">
                <div class="day-row" *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']">
                  <div class="day-label">{{ day }}</div>
                  <div class="day-slots">
                    <div class="time-slot" *ngFor="let hour of [8,9,10,11,12,13,14,15,16,17]">
                      <!-- Session blocks would be positioned here based on time -->
                      <div *ngFor="let session of weeklyTimetable" 
                           class="session-block"
                           [style.display]="session.day === day && 
                                            (session.startTime.split(':')[0] <= hour && 
                                             session.endTime.split(':')[0] > hour) ? 'block' : 'none'">
                        {{ session.title || 'Available' }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="upcoming-sessions">
            <h3>Upcoming Sessions</h3>
            <table class="sessions-table">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Date</th>
                  <th>Time</th>
                  <th>Venue</th>
                  <th>Students</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let session of counselorSessions">
                  <td>{{ session.title }}</td>
                  <td>{{ session.date | date }}</td>
                  <td>{{ session.startTime }} - {{ session.endTime }}</td>
                  <td>{{ session.venue }}</td>
                  <td>{{ session.participants?.length || 0 }}/{{ session.maxParticipants }}</td>
                  <td>
                    <button class="btn btn-sm">
                      <i class="fas fa-eye"></i> View
                    </button>
                    <button class="btn btn-sm btn-danger" (click)="cancelSession(session.id)">
                      <i class="fas fa-times"></i> Cancel
                    </button>
                  </td>
                </tr>
                <tr *ngIf="!counselorSessions.length">
                  <td colspan="6" class="text-center">No upcoming sessions</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>
  
      <!-- Messages Section -->
      <section id="messages" class="dashboard-section" *ngIf="activeSection === 'messages'">
        <h2>Messages</h2>
        
        <div class="messages-container">
          <div class="contacts-sidebar">
            <div class="search-box">
              <input type="text" placeholder="Search conversations...">
            </div>
            
            <div class="contacts-list">
              <div class="contact-item" *ngFor="let student of students" 
                   [class.active]="selectedConversation?.student?.id === student.id"
                   (click)="loadConversation(student)">
                <div class="contact-avatar">
                  <img src="/api/placeholder/40/40" alt="Contact">
                  <span class="status-dot" [ngClass]="student.status || 'offline'"></span>
                </div>
                <div class="contact-info">
                  <h4>{{ student.name }}</h4>
                  <p>{{ student.faculty || 'No Faculty' }}</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="conversation-view">
            <div class="conversation-header" *ngIf="selectedConversation">
              <div class="contact-info">
                <img src="/api/placeholder/40/40" alt="Contact">
                <div>
                  <h3>{{ selectedConversation.student.name }}</h3>
                  <p [ngClass]="selectedConversation.student.status || 'offline'">
                    {{ selectedConversation.student.status || 'Offline' }}
                  </p>
                </div>
              </div>
              <div class="header-actions">
                <button class="btn">
                  <i class="fas fa-phone"></i>
                </button>
                <button class="btn">
                  <i class="fas fa-video"></i>
                </button>
                <button class="btn">
                  <i class="fas fa-info-circle"></i>
                </button>
              </div>
            </div>
            
            <div class="conversation-placeholder" *ngIf="!selectedConversation">
              <div class="placeholder-content">
                <i class="fas fa-comments"></i>
                <h3>Select a conversation</h3>
                <p>Choose a student from the list to start or continue a conversation.</p>
              </div>
            </div>
            
            <div class="messages-list" *ngIf="selectedConversation">
              <div *ngFor="let message of selectedConversation.messages" 
                   class="message" 
                   [ngClass]="{'outgoing': message.sender_id === (currentUser?.id || currentUser?.userId), 
                              'incoming': message.sender_id !== (currentUser?.id || currentUser?.userId)}">
                <div class="message-content">
                  {{ message.content }}
                </div>
                <div class="message-time">
                  {{ message.sent_at | date:'shortTime' }}
                  <span class="read-status" *ngIf="message.sender_id === (currentUser?.id || currentUser?.userId)">
                    <i class="fas" [ngClass]="message.is_read ? 'fa-check-double' : 'fa-check'"></i>
                  </span>
                </div>
              </div>
            </div>
            
            <div class="message-input" *ngIf="selectedConversation">
              <input type="text" placeholder="Type a message..." [(ngModel)]="messageContent">
              <button (click)="sendMessage()">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </div>
        </div>
      </section>
  
      <!-- Community Section -->
      <section id="community" class="dashboard-section" *ngIf="activeSection === 'community'">
        <h2>Community Board</h2>
        
        <div class="community-container">
          <div class="create-post">
            <h3>Create Post</h3>
            <div class="post-form">
              <textarea placeholder="Share something with the community..." [(ngModel)]="newPostContent"></textarea>
              <button class="btn" (click)="createPost()">Post</button>
            </div>
          </div>
          
          <div class="posts-feed">
            <h3>Recent Posts</h3>
            <div class="post-card" *ngFor="let post of communityPosts">
              <div class="post-header">
                <div class="author-info">
                  <img src="/api/placeholder/40/40" alt="Author">
                  <div>
                    <h4>{{ post.author?.name || 'Unknown User' }}</h4>
                    <p>{{ post.created_at | date }}</p>
                  </div>
                </div>
                <div class="post-actions">
                  <button class="btn btn-sm">
                    <i class="fas fa-ellipsis-v"></i>
                  </button>
                </div>
              </div>
              <div class="post-content">
                {{ post.content }}
              </div>
              <div class="post-footer">
                <div class="interaction-stats">
                  <span><i class="fas fa-heart"></i> {{ post.likes || 0 }}</span>
                  <span><i class="fas fa-comment"></i> {{ post.comment_count || 0 }}</span>
                </div>
                <button class="btn" (click)="viewPostDetails(post)">
                  View Comments
                </button>
              </div>
            </div>
          </div>
          
          <!-- Post Detail Modal -->
          <div class="modal" *ngIf="selectedPost">
            <div class="modal-content">
              <div class="modal-header">
                <h3>Post Details</h3>
                <button (click)="selectedPost = null" class="close-btn">&times;</button>
              </div>
              <div class="modal-body">
                <div class="post-detail">
                  <div class="post-author">
                    <img src="/api/placeholder/40/40" alt="Author">
                    <div>
                      <h4>{{ selectedPost.author?.name || 'Unknown User' }}</h4>
                      <p>{{ selectedPost.created_at | date }}</p>
                    </div>
                  </div>
                  <div class="post-content">
                    {{ selectedPost.content }}
                  </div>
                  
                  <div class="comments-section">
                    <h4>Comments ({{ postComments.length }})</h4>
                    <div class="comment-list">
                      <div class="comment" *ngFor="let comment of postComments">
                        <div class="comment-author">
                          <img src="/api/placeholder/30/30" alt="Commenter">
                          <div>
                            <h5>{{ comment.author?.name || 'Unknown User' }}</h5>
                            <p>{{ comment.created_at | date }}</p>
                          </div>
                        </div>
                        <div class="comment-content">
                          {{ comment.content }}
                        </div>
                      </div>
                      <div *ngIf="!postComments.length" class="no-comments">
                        No comments yet.
                      </div>
                    </div>
                    
                    <div class="add-comment">
                      <textarea placeholder="Add a comment..." [(ngModel)]="newCommentContent"></textarea>
                      <button (click)="addComment()">Comment</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
  
      <!-- Reports Section -->
      <section id="reports" class="dashboard-section" *ngIf="activeSection === 'reports'">
        <h2>Reports</h2>
        
        <div class="reports-container">
          <div class="report-card">
            <div class="card-header">
              <h3>Generate Summary Report</h3>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label for="report-faculty">Faculty Filter (Optional)</label>
                <select id="report-faculty" [(ngModel)]="selectedFaculty">
                  <option value="">All Faculties</option>
                  <option *ngFor="let faculty of faculties" [value]="faculty">{{ faculty }}</option>
                </select>
              </div>
              
              <div class="form-group">
                <label>Date Range</label>
                <div class="date-range">
                  <div class="form-group">
                    <label for="report-start-date">From:</label>
                    <input type="date" id="report-start-date" [(ngModel)]="startDate">
                  </div>
                  <div class="form-group">
                    <label for="report-end-date">To:</label>
                    <input type="date" id="report-end-date" [(ngModel)]="endDate">
                  </div>
                </div>
              </div>
              
              <button class="btn" (click)="generateSummaryReport()">
                Generate Report
              </button>
            </div>
          </div>
          
          <div class="report-card">
            <div class="card-header">
              <h3>Individual Student Reports</h3>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label for="student-select">Select Student</label>
                <select id="student-select" [(ngModel)]="selectedStudent" [compareWith]="compareStudentObjects">
                  <option [ngValue]="null">-- Select a Student --</option>
                  <option *ngFor="let student of students" [ngValue]="student">
                    {{ student.name }}
                  </option>
                </select>
              </div>
              
              <button class="btn" [disabled]="!selectedStudent" (click)="generateStudentReport()">
                Generate Student Report
              </button>
            </div>
          </div>
        </div>
        
        <div class="recent-reports">
          <h3>Recent Reports</h3>
          <table class="reports-table">
            <thead>
              <tr>
                <th>Report Name</th>
                <th>Generated On</th>
                <th>Type</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Weekly Student Activity</td>
                <td>{{ (today - 2*24*60*60*1000) | date }}</td>
                <td>Summary</td>
                <td>
                  <button class="btn btn-sm">
                    <i class="fas fa-download"></i> Download
                  </button>
                  <button class="btn btn-sm">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
              <tr>
                <td>Jane Smith Progress Report</td>
                <td>{{ (today - 5*24*60*60*1000) | date }}</td>
                <td>Individual</td>
                <td>
                  <button class="btn btn-sm">
                    <i class="fas fa-download"></i> Download
                  </button>
                  <button class="btn btn-sm">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
              <tr>
                <td>Engineering Faculty Usage</td>
                <td>{{ (today - 7*24*60*60*1000) | date }}</td>
                <td>Summary</td>
                <td>
                  <button class="btn btn-sm">
                    <i class="fas fa-download"></i> Download
                  </button>
                  <button class="btn btn-sm">
                    <i class="fas fa-eye"></i> View
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </div>