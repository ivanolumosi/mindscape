<!-- chat-app.component.html -->
<div class="chat-container">
  <app-sidebar></app-sidebar>
  <!-- Chat Content -->
  <div class="chat-content">
    <!-- Chat List -->
    <div class="chat-list">
      <div class="chat-list-header">
        <h2>Conversations</h2>
        <button class="new-chat-btn">
          <i class="fas fa-plus"></i>
        </button>
      </div>
      
      <div class="chat-search">
        <div class="search-box">
          <i class="fas fa-search search-icon"></i>
          <input type="text" placeholder="Search conversations..." class="search-input">
        </div>
      </div>
      
      <div class="chat-contacts">
        <div *ngIf="contacts.length === 0" class="no-contacts">
          <p>No conversations yet.</p>
        </div>
        
        <div *ngFor="let contact of contacts"
             class="contact-item"
             [class.active]="selectedContact && selectedContact.id === contact.id"
             [class.unread]="contact.unreadCount > 0"
             (click)="selectContact(contact)">
          <div class="contact-avatar">
            <img [src]="contact.avatar" alt="Contact Avatar">
            <span class="status-indicator" [ngClass]="contact.status"></span>
            <span *ngIf="contact.unreadCount > 0" class="unread-badge">{{contact.unreadCount}}</span>
          </div>
          <div class="contact-info">
            <div class="contact-header">
              <span class="contact-name">{{contact.name}}</span>
              <span class="contact-time">{{formatTime(contact.timestamp)}}</span>
            </div>
            <div class="contact-message">{{contact.lastMessage}}</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Chat Messages -->
    <div class="chat-messages" *ngIf="selectedContact">
      <div class="chat-header">
        <div class="contact-info">
          <div class="contact-avatar">
            <img [src]="selectedContact.avatar" alt="Contact Avatar">
            <span class="status-indicator" [ngClass]="selectedContact.status"></span>
          </div>
          <div class="contact-details">
            <div class="contact-name">{{selectedContact.name}}</div>
            <div class="contact-status">{{selectedContact.status}}</div>
          </div>
        </div>
        <div class="chat-actions">
          <button class="action-btn"><i class="fas fa-info-circle"></i></button>
          <button class="action-btn" (click)="deleteConversation()"><i class="fas fa-trash"></i></button>
        </div>
      </div>
      
      <div class="message-container">
        <div *ngIf="messages.length === 0" class="no-messages">
          <p>No messages yet. Start a conversation!</p>
        </div>
        
        <div *ngFor="let message of messages; let i = index; let isFirst = first">
          <!-- Date separator -->
          <div *ngIf="isFirst || formatDate(messages[i-1].timestamp) !== formatDate(message.timestamp)" class="date-separator">
            <span>{{formatDate(message.timestamp)}}</span>
          </div>
          
          <div class="message" [class.own-message]="message.isOwnMessage">
            <div class="message-avatar" *ngIf="!message.isOwnMessage">
              <img [src]="selectedContact.avatar" alt="Avatar">
            </div>
            <div class="message-content">
              <div class="message-bubble">
                <div class="message-text">{{message.content}}</div>
              </div>
              <div class="message-info">
                <span class="message-time">{{formatTime(message.timestamp)}}</span>
                <span *ngIf="message.isOwnMessage" class="message-status">
                  <i class="fas" [ngClass]="{'fa-check-double': message.isRead, 'fa-check': !message.isRead}"></i>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="message-composer">
        <button class="composer-btn"><i class="fas fa-paperclip"></i></button>
        <div class="composer-input-container">
          <input type="text" 
                class="composer-input" 
                placeholder="Type a message..." 
                [(ngModel)]="newMessage" 
                (keyup.enter)="sendMessage()">
          <button class="emoji-btn" (click)="toggleEmojiPicker()">
            <i class="far fa-smile"></i>
          </button>
          <div *ngIf="showEmojiPicker" class="emoji-picker">
            <!-- Simple emoji options -->
            <div class="emoji-list">
              <span (click)="addEmoji('ğŸ˜Š')">ğŸ˜Š</span>
              <span (click)="addEmoji('ğŸ‘')">ğŸ‘</span>
              <span (click)="addEmoji('â¤ï¸')">â¤ï¸</span>
              <span (click)="addEmoji('ğŸ˜‚')">ğŸ˜‚</span>
              <span (click)="addEmoji('ğŸ™')">ğŸ™</span>
              <span (click)="addEmoji('ğŸ‘‹')">ğŸ‘‹</span>
              <span (click)="addEmoji('ğŸ‰')">ğŸ‰</span>
              <span (click)="addEmoji('ğŸ¤”')">ğŸ¤”</span>
            </div>
          </div>
        </div>
        <button class="send-btn" [disabled]="!newMessage.trim()" (click)="sendMessage()">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
    
    <!-- Empty state when no contact is selected -->
    <div class="empty-chat" *ngIf="!selectedContact">
      <div class="empty-chat-content">
        <img src="assets/images/chat-placeholder.png" alt="Select a conversation">
        <h3>Select a conversation</h3>
        <p>Choose a contact to start chatting</p>
      </div>
    </div>
  </div>
</div>